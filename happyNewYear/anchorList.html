<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
<meta content="yes" name="apple-mobile-web-app-capable">
<meta content="black" name="apple-mobile-web-app-status-bar-style">
<meta content="telephone=no" name="format-detection">
<meta content="email=no" name="format-detection">
<meta name="description" content="不超过150个字符"/>
<meta name="keywords" content=""/>
<meta content="" name="author"/>
<title></title>
<link rel="stylesheet" href="./anchorList.css">
<script src="./axios.js"></script>
<script src="./vue.js"></script>
<!-- 引入样式 -->
<!-- <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css"> -->
<!-- 引入组件库 // that.$message(response.data.msg); -->
<!-- <script src="https://unpkg.com/element-ui/lib/index.js"></script> -->
<!-- 引入样式文件 -->
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vant@2.10/lib/index.css"> -->
<!-- <link rel="stylesheet" href="./vant.js"> -->
<!-- 引入 Vue 和 Vant 的 JS 文件 -->
<!-- <script src="https://cdn.jsdelivr.net/npm/vue@2.6/dist/vue.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/vant@2.10/lib/vant.min.js"></script> -->
<!-- <script src="./vant.js"></script> -->

<script type="text/javascript">
//引入该flexible.min.js
!function(e,t){function n(){var n=l.getBoundingClientRect().width;t=t||540,n>t&&(n=t);var i=100*n/e;r.innerHTML="html{font-size:"+i+"px;}"}var i,d=document,o=window,l=d.documentElement,r=document.createElement("style");if(l.firstElementChild)l.firstElementChild.appendChild(r);else{var a=d.createElement("div");a.appendChild(r),d.write(a.innerHTML),a=null}n(),o.addEventListener("resize",function(){clearTimeout(i),i=setTimeout(n,300)},!1),o.addEventListener("pageshow",function(e){e.persisted&&(clearTimeout(i),i=setTimeout(n,300))},!1),"complete"===d.readyState?d.body.style.fontSize="16px":d.addEventListener("DOMContentLoaded",function(e){d.body.style.fontSize="16px"},!1)}(750,1200);
</script>
</head>
  <body>
    <div id="app">
        <div class="contenter">
            <div class="topArea">
                <img class="newYear" src="./img/newYear.png" alt="">
                <img class="timeInfo" src="./img/timeBg.png" alt="">
                <div class="ruleBtn" :class="'ruleBtn'+language" @click="goPages(1)">
                  {{acRuleText[language]}}
                </div>
                <div class="priseBtn" :class="'priseBtn'+language" @click="goPages(0)">
                  {{acPriseText[language]}}
                </div>
            </div>
            <!-- swichBar -->
            <div class="swichBarArea" :class="'swichBarArea'+language">
                <span :class="swichBarStatus==index?'spanAc':''" class="span" v-for="(item,index) in swichBarText" :key="index" @click="swichRankList(index)">{{item[language]}}</span>
            </div>
            <!-- listArea  新年榜-->
            <div class="listAreaWrap" v-if="swichBarStatus==0">
                <div class="listArea">
                    <div class="otherList">
                        <div class="noData" v-if="achorRankData.length==0">{{noData[language]}}</div>
                        <div class="otherPer" v-for="(item,index) in achorRankData" :key="index">
                            <span class="indexes">{{item.pos}}</span>
                            <div class="imgBox" @click="gooPersonalPage(item.useridx)">
                              <img class="photo" :src="item.smallpic" alt="">
                            </div>
                            <div class="info" @click="gooPersonalPage(item.useridx)">
                              <p class="name">{{item.myname}}</p>
                              <p class="id">ID:{{item.useridx}}</p>
                            </div>
                            <div class="giftNum" :class="'giftNum'+language">
                              <p class="name">{{luckText[language]}}</p>
                              <p class="id">{{item.AllPower}}</p>
                            </div>
                        </div>
                    </div>
                    <div class="myList">
                        <span class="indexes" v-if="achorMydata.rowNo==0">No</span>
                        <span class="indexes" v-else>{{achorMydata.rowNo}}</span>
                        <div class="imgBox">
                          <img class="photo" :src="achorMydata.smallpic" alt="">
                        </div>
                        <div class="info">
                          <p class="name">{{achorMydata.myname}}</p>
                          <p class="id">ID:{{achorMydata.useridx}}</p>
                        </div>
                        <div class="giftNum" :class="'giftNum'+language">
                          <p class="name">{{luckText[language]}}</p>
                          <p class="id">{{achorMydata.giftnum}}</p>
                        </div>
                    </div>
                </div>
            </div>
            <!-- listArea  快乐榜-->
            <div class="listAreaWrap" v-if="swichBarStatus==1">
                <div class="listArea">
                    <div class="otherList">
                        <div class="noData" v-if="userRankData.length==0">{{noData[language]}}</div>
                        <div class="otherPer" v-for="(item,index) in userRankData" :key="index">
                            <span class="indexes">{{item.pos}}</span>
                            <div class="imgBox" @click="gooPersonalPage(item.useridx)">
                              <img class="photo" :src="item.smallpic" alt="">
                            </div>
                            <div class="info" @click="gooPersonalPage(item.useridx)">
                              <p class="name">{{item.myname}}</p>
                              <p class="id">ID:{{item.useridx}}</p>
                            </div>
                            <div class="giftNum" :class="'giftNum'+language">
                              <p class="name">{{luckText[language]}}</p>
                              <p class="id">{{item.AllPower}}</p>
                            </div>
                        </div>
                    </div>
                    <div class="myList">
                        <span class="indexes" v-if="userMyData.rowNo==0">No</span>
                        <span class="indexes" v-else>{{userMyData.rowNo}}</span>
                        <div class="imgBox">
                          <img class="photo" :src="userMyData.smallpic" alt="">
                        </div>
                        <div class="info">
                          <p class="name">{{userMyData.myname}}</p>
                          <p class="id">ID:{{userMyData.useridx}}</p>
                        </div>
                        <div class="giftNum" :class="'giftNum'+language">
                          <p class="name">{{luckText[language]}}</p>
                          <p class="id">{{userMyData.giftnum}}</p>
                        </div>
                    </div>
                </div>
            </div>

 


        </div>
    </div>
    <!-- built files will be auto injected -->
  </body>
  <script type="text/javascript">
    new Vue({
        el:'#app',
        data(){
          return{
            webUrl:'http://173.248.234.198:2020/',//web before https://api.bunnylive.me/  test  http://173.248.234.198:2020/
            language:0,//0中   1英   2太
            acRuleText:['活动规则','Activity Rules','quy tắc hoạt động'],
            acPriseText:['活动奖励','Activity Award','Giải thưởng hoạt động'],
            swichBarText:[['新年榜','New Year list','Danh sách năm mới'],
                          ['快乐榜','Happy list','Danh sách hạnh phúc ']],
            swichBarStatus:0,//默认榜单
            luckText:['福气值','Blessing value','Điểm chúc phúc'],
            achorRankData:[],//主播榜   新年榜-主播
            achorMydata:{},//主播  我的  新年榜-主播
            userRankData:[],//用户榜  快乐榜-用户
            userMyData:{},//用户  我的  快乐榜-用户



            noData:['暂无数据','No data','Chưa có dữ liệu '],//暂无数据  
            notInList:['暂未上榜','Not yet on the list','Không có trong danh sách'],//暂未上榜 
          }   
        },
        created() {
          this.getInitLunguage()
          this.getRankList()

        },
        computed:{
        },
        methods:{
            //获取 token ranktype 等公共函数
            GetQueryString:function(name) { //name为要获得的参数名字 
              var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)")
              var r = window.location.search.substr(1).match(reg)
              if(r != null) return decodeURI(r[2])
              return null;
              // if(r != null){
              //     this.language=decodeURI(r[2])
              // }else{
              //     this.language=0;
              // }
            },
            getInitLunguage:function(){
              var lang = navigator.language||navigator.userLanguage;//常规浏览器语言和IE浏览器
              lang = lang.substr(0, 2);//截取lang前2位字符
              console.log(lang)
              if(lang == 'zh'){
                this.language=0;
              }else if(lang == 'en'){
                this.language=1;
              }else if(lang == 'vi'){
                this.language=2;
              }else{
                this.language=0;
              }
            },
            goPages:function(id){
              console.log(id)
              if(id==0){//奖励
                window.location.href ="./listAwards.html?token="+this.GetQueryString('token'); rel="external nofollow";
              }else if(id==1){//规则
                window.location.href ="./rule.html?token="+this.GetQueryString('token'); rel="external nofollow";
              }
            },
            swichRankList:function(id){//切换榜单
              console.log(id)
              this.swichBarStatus=id;
            },
            getRankList:function(rankId){
              // console.log(rankId)
              // console.log(this.acRankStatus)

              var token = this.GetQueryString('token')
              // console.log(token)
              var url = this.webUrl+'H5/Active/NewYear2021Rank';
              var that =this;
              axios.post(url, {
                token:token
              })
              .then(function (response) {
                console.log(response.data.data)
                // that.totalInitData=response.data.data;
                
                that.achorRankData=response.data.data.idollist;//主播榜
                that.achorMydata=response.data.data.myidolrank;//主播  我的
                that.userRankData=response.data.data.userlist;//用户榜
                that.userMyData=response.data.data.myuserrank;//用户  我的
                
                // that.achorLevalNum=response.data.data.myidolrank.giftnum;//主播
                // that.userLevalNum=response.data.data.myuserrank.giftnum;//用户


              })
              .catch(function (error) {
                console.log(error);
              });
            },
            productType:function(){
              var ios = 'ios';
              var android = 'android';
              var u = navigator.userAgent, app = navigator.appVersion;
              var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1; //g
              var isIOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
              if (isAndroid) {
                 //这个是安卓操作系统
                 return 1;
              }
              if (isIOS) {
              　　//这个是ios操作系统
                return 0;
              }
            },
            gooPersonalPage:function(idx){//0 i0s 1 android
              // console.log(idx)
              // console.log(this.productType())
              if(this.productType()==0){
                document.location = "miaobowpa:/ShowCard&useridx=" + idx + "&";
              }else if(this.productType()==1){
                window.location.href = "miaobowpa://ShowCard?useridx=" + idx;
              }
            },






            


            
            getInitGiftMsg:function(){
              var token = this.GetQueryString('token')
              // console.log(token)
              var url = this.webUrl+'H5/Active/LuckyStarBoxStatus';
              var that =this;
              axios.post(url, {
                token:token
              })
              .then(function (response) {
                console.log(response.data)
                var initData=that.giftStatus;
                var newData=response.data.data;

                initData.forEach(function(item,index){
                  newData.forEach(function(item1,index1){
                    if(item1.BoxType==item.id){
                      that.giftStatus[index].status=1;
                      that.giftStatus[index].coin=item1.Coin;
                    }
                  })
                })
                
               
              })
              .catch(function (error) {
                console.log(error);
              });
            },
            openBox:function(typeId){
              var token = this.GetQueryString('token')
              var url = this.webUrl+'H5/Active/LuckyStarOpenPrize';
              var that = this;
              axios.post(url, {
                token:token,
                Type:typeId
              })
              .then(function (response) {
                // console.log(response.data)
                  if(response.data.code==100){
                    that.giftStatus[typeId-1].coin=response.data.data;
                    that.giftStatus[typeId-1].status=1;
                  
                  }
                  vant.Toast(response.data.msg);
              })
              .catch(function (error) {
                console.log(error);
              });
            },
            getScrollMsg:function(){
                var that = this;
                window.onscroll = function(){  // 由于需要使用 onPageScroll 无法使用 scroll-view 所以使用onscroll来判断页面是否滚动到底部
                    //变量scrollTop是滚动条滚动时，距离顶部的距离
                    var scrollTop = document.documentElement.scrollTop;
                    //变量windowHeight是可视区的高度
                    var windowHeight = document.documentElement.clientHeight;
                    //变量scrollHeight是滚动条的总高度
                    var scrollHeight = document.documentElement.scrollHeight;
                            console.log(scrollTop)
                            console.log(windowHeight)
                            console.log(scrollHeight)
                          //滚动条到底部的条件
                    if(scrollTop+windowHeight==scrollHeight){
                      //写后台加载数据的函数
                      console.log("距顶部"+scrollTop+"可视区高度"+windowHeight+"滚动条总高度"+scrollHeight);
                      console.log('滚动到底')
                      that.listData.push({name:'小野444猫',num:123,url:'./img/bg10.png'},)

                    }   
                }
            },
          
        },
        beforeMount(){
        },
        mounted(){
        },
       
    })
  </script>
</html>
