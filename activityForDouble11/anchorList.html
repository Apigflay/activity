<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
<meta content="yes" name="apple-mobile-web-app-capable">
<meta content="black" name="apple-mobile-web-app-status-bar-style">
<meta content="telephone=no" name="format-detection">
<meta content="email=no" name="format-detection">
<meta name="description" content="不超过150个字符"/>
<meta name="keywords" content=""/>
<meta content="" name="author"/>
<title></title>
<link rel="stylesheet" href="./anchorList.css">
<script src="./axios.js"></script>
<script src="./vue.js"></script>
<!-- 引入样式 -->
<!-- <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css"> -->
<!-- 引入组件库 // that.$message(response.data.msg); -->
<!-- <script src="https://unpkg.com/element-ui/lib/index.js"></script> -->
<!-- 引入样式文件 -->
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vant@2.10/lib/index.css"> -->
<!-- 引入 Vue 和 Vant 的 JS 文件 -->
<!-- <script src="https://cdn.jsdelivr.net/npm/vue@2.6/dist/vue.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/vant@2.10/lib/vant.min.js"></script> -->

<script type="text/javascript">
//引入该flexible.min.js
!function(e,t){function n(){var n=l.getBoundingClientRect().width;t=t||540,n>t&&(n=t);var i=100*n/e;r.innerHTML="html{font-size:"+i+"px;}"}var i,d=document,o=window,l=d.documentElement,r=document.createElement("style");if(l.firstElementChild)l.firstElementChild.appendChild(r);else{var a=d.createElement("div");a.appendChild(r),d.write(a.innerHTML),a=null}n(),o.addEventListener("resize",function(){clearTimeout(i),i=setTimeout(n,300)},!1),o.addEventListener("pageshow",function(e){e.persisted&&(clearTimeout(i),i=setTimeout(n,300))},!1),"complete"===d.readyState?d.body.style.fontSize="16px":d.addEventListener("DOMContentLoaded",function(e){d.body.style.fontSize="16px"},!1)}(750,750);
</script>
</head>
  <body>
    <div id="app">
        <div class="contenter">
          <div class="ruleBtn" @click="goPages(0)">{{ruleText[language]}}</div>
          <div class="priseBtn" @click="goPages(1)">{{priseText[language]}}</div>
          <div class="listArea">
              <div class="title">
                <span class="span1" @click="swichList(0)" :class="listAcStatus==0?'acSpan':'span'">{{list1Text[language]}}</span>
                <span class="span2" @click="swichList(1)" :class="listAcStatus==1?'acSpan':'span'">{{list2Text[language]}}</span>
              </div>
              <div class="listBox" v-if="listAcStatus==0">
                  <div class="per" v-for="(item,index) in popListData" :key="index">
                    <span class="index">{{item.rowNo}}</span>
                    <img class="photo" :src="item.smallpic" alt="" @click="gooPersonalPage(item.useridx)">
                    <span class="name" @click="gooPersonalPage(item.useridx)">{{item.myname}}</span>
                    <div class="info">
                        {{popText[language]}}<br>
                        <span class="bigText">{{item.giftnum}}</span>
                    </div>
                  </div>
              </div>  
               <!--  -->
                <div class="listBox" v-if="listAcStatus==1">
                  <div class="per" v-for="(item,index) in guaListData" :key="index">
                    <span class="index">{{item.rowNo}}</span>
                    <img class="photo" :src="item.smallpic" alt="" @click="gooPersonalPage(item.useridx)">
                    <span class="name" @click="gooPersonalPage(item.useridx)">{{item.myname}}</span>
                    <div class="info">
                        {{guaText[language]}}<br>
                        <span class="bigText">{{item.giftnum}}</span>
                    </div>
                  </div>
              </div>    
          </div>
          <!--  -->
          <div class="kong"></div>
          <div class="popPer fixedPer" v-if="listAcStatus==0" >
            <span class="index" v-if="myPopData.rowNo!=0">{{myPopData.rowNo}}</span>
            <span class="index" v-if="myPopData.rowNo==0">No</span>
            <img class="photo" :src="myPopData.smallpic" alt="">
            <span class="name">{{myPopData.myname}}</span>
            <div class="info">
                {{popText[language]}}<br>
                <span class="bigText">{{myPopData.giftnum}}</span>
            </div>
          </div>  
          <div class="guaPer fixedPer" v-if="listAcStatus==1">
            <span class="index" v-if="myGuaData.rowNo!=0">{{myGuaData.rowNo}}</span>
            <span class="index" v-if="myGuaData.rowNo==0">No</span>
            <img class="photo" :src="myGuaData.smallpic" alt="">
            <span class="name">{{myGuaData.myname}}</span>
            <div class="info">
                {{guaText[language]}}<br>
                <span class="bigText">{{myGuaData.giftnum}}</span>
            </div>
          </div>




                       




        </div>
    </div>
    <!-- built files will be auto injected -->
  </body>
  <script type="text/javascript">
    new Vue({
        el:'#app',
        data(){
          return{
            webUrl:'https://api.bunnylive.me/',//web before https://api.bunnylive.me/  test  http://173.248.234.130:2027/
            language:0,//0中   1英   2太
            ruleText:['活动规则','Activity rule','Quy tắc sự kiện'],
            priseText:['活动奖励','Activity Award','Giải thưởng từ sự kiện'],
            list1Text:['人气榜','Popularity list','Danh sách độ hot '],
            list2Text:['守护榜','Guardian list','Danh sách điểm bảo hộ'],
            listAcStatus:0,//0 人气榜 1 守护榜
            popListData:[],//人气榜
            guaListData:[],//守护榜
            myPopData:{giftnum:0,myname:null,rowNo:0,smallpic:null,useridx:0},//我的人气榜
            myGuaData:{giftnum:0,myname:null,rowNo:0,smallpic:null,useridx:0},//我的守护榜
            popText:['人气值','Popularity value','Độ hot'],//人气值
            guaText:['守护值','Guardian value','Điểm bảo hộ'],





            
          }   
        },
        created() {
          this.getInitLunguage()
          this.getInitGiftMsg()
          // this.getRankList(this.acRankStatus)

        },
        computed:{
        },
        methods:{
          getInitLunguage:function(){
              var lang = navigator.language||navigator.userLanguage;//常规浏览器语言和IE浏览器
              lang = lang.substr(0, 2);//截取lang前2位字符
              console.log(lang)
              if(lang == 'zh'){
                this.language=0;
              }else if(lang == 'en'){
                this.language=1;
              }else if(lang == 'vi'){
                this.language=2;
              }else{
                this.language=0;
              }
            },
            swichList:function(id){//切换榜单
              this.listAcStatus=id;
            },
            //获取 token ranktype 等公共函数
            GetQueryString:function(name) { //name为要获得的参数名字 
              var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)")
              var r = window.location.search.substr(1).match(reg)
              if(r != null) return decodeURI(r[2])
              return null;
              // if(r != null){
              //     this.language=decodeURI(r[2])
              // }else{
              //     this.language=0;
              // }
            },
            productType:function(){
              var ios = 'ios';
              var android = 'android';
              var u = navigator.userAgent, app = navigator.appVersion;
              var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1; //g
              var isIOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
              if (isAndroid) {
                 //这个是安卓操作系统
                 return 1;
              }
              if (isIOS) {
              　　//这个是ios操作系统
                return 0;
              }
            },
            getInitGiftMsg:function(){
              var token = this.GetQueryString('token')
              // console.log(token)
              var url = this.webUrl+'H5/Active/DoubleElevenRank';
              var that =this;
              axios.post(url, {
                token:token
              })
              .then(function (response) {
                console.log(response.data)
                that.popListData=response.data.data.idolrank;//人气榜
                that.guaListData=response.data.data.userrank;//守护榜
                that.myPopData=response.data.data.myidolrank;//我的人气榜
                that.myGuaData=response.data.data.myuserrank;//我的守护榜
                
               
              })
              .catch(function (error) {
                console.log(error);
              });
            },
            goPages:function(id){
              console.log(id)
              if(id==1){//奖励
                window.location.href ="./down.html"; rel="external nofollow";
              }else if(id==0){//规则
                window.location.href ="./rule.html"; rel="external nofollow";
              }
            },
            gooPersonalPage:function(idx){//0 i0s 1 android
              // console.log(idx)
              // console.log(this.productType())
              if(this.productType()==0){
                document.location = "miaobowpa:/ShowCard&useridx=" + idx + "&";
              }else if(this.productType()==1){
                window.location.href = "miaobowpa://ShowCard?useridx=" + idx;
              }
            },





            
            openBox:function(typeId){
              var token = this.GetQueryString('token')
              var url = this.webUrl+'H5/Active/LuckyStarOpenPrize';
              var that = this;
              axios.post(url, {
                token:token,
                Type:typeId
              })
              .then(function (response) {
                // console.log(response.data)
                  if(response.data.code==100){
                    that.giftStatus[typeId-1].coin=response.data.data;
                    that.giftStatus[typeId-1].status=1;
                  
                  }
                  vant.Toast(response.data.msg);
              })
              .catch(function (error) {
                console.log(error);
              });
            },
            getRankList:function(rankId){
              // console.log(rankId)
              // console.log(this.acRankStatus)

              var token = this.GetQueryString('token')
              // console.log(token)
              var url = this.webUrl+'H5/Active/LuckyStarRank';
              var that =this;
              axios.post(url, {
                token:token
              })
              .then(function (response) {
                // console.log(response.data.data)
                that.totalInitData=response.data.data;
                that.achorRankData=response.data.data.idollist;//主播榜
                that.achorMydata=response.data.data.myidolrank;//主播  我的
                that.userRankData=response.data.data.userlist;//用户榜
                that.userMyData=response.data.data.myuserrank;//用户  我的
                that.achorLevalNum=response.data.data.myidolrank.giftnum;//主播
                that.userLevalNum=response.data.data.myuserrank.giftnum;//用户


              })
              .catch(function (error) {
                console.log(error);
              });
            },


            getScrollMsg:function(){
                var that = this;
                window.onscroll = function(){  // 由于需要使用 onPageScroll 无法使用 scroll-view 所以使用onscroll来判断页面是否滚动到底部
                    //变量scrollTop是滚动条滚动时，距离顶部的距离
                    var scrollTop = document.documentElement.scrollTop;
                    //变量windowHeight是可视区的高度
                    var windowHeight = document.documentElement.clientHeight;
                    //变量scrollHeight是滚动条的总高度
                    var scrollHeight = document.documentElement.scrollHeight;
                            console.log(scrollTop)
                            console.log(windowHeight)
                            console.log(scrollHeight)
                          //滚动条到底部的条件
                    if(scrollTop+windowHeight==scrollHeight){
                      //写后台加载数据的函数
                      console.log("距顶部"+scrollTop+"可视区高度"+windowHeight+"滚动条总高度"+scrollHeight);
                      console.log('滚动到底')
                      that.listData.push({name:'小野444猫',num:123,url:'./img/bg10.png'},)

                    }   
                }
            },
          
        },
        beforeMount(){
        },
        mounted(){
        },
       
    })
  </script>
</html>
